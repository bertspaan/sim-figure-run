<!DOCTYPE html>
<html>
<head>
	<title>SIM Figure Run</title>
  <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" href="style.css" />
  <!-- <link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,700' rel='stylesheet' type='text/css'> -->  
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js?2"></script>
</head>
<body>
  <div id="info">
    
  </div>
  <div id="map">
  </div>
	<script>    
		var map = L.map('map');
    
    //http://127.0.0.1:20008/tile/sim-figure-run/14/8414/5386.png?updated=1390253785000&metatile=1&scale=1
    
		var tileLayer = L.tileLayer("http://otile2.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png", {
		//var tileLayer = L.tileLayer("http://127.0.0.1:20008/tile/sim-figure-run/{z}/{x}/{y}.png?updated=1391253780000&metatile=1&scale=1", {
      attributionControl: false,
			minZoom: 12,
			maxZoom: 16
		}).addTo(map);
    map.setView([52.3674, 4.915], 14);
        
    
    d3.json("routes.json", function(json) {
      var geojson = {
        type: "FeatureCollection",
        features: []          
      };
      
      json.forEach(function(route) {
        var geometry = route.coordinates;
        geometry.coordinates.map(Array.reverse);
        var feature = {
          type: "Feature",
          properties: {
            id: route.routeid,
            date: route.date,
            walked: (route.walked > 0)
          },
          geometry: geometry
        }
        geojson.features.push(feature);          
      });      

      L.geoJson(geojson, {
        style: function(feature) {
          switch (feature.properties.walked) {
            case true:  return {color: "#ffff00"};
            case false: return {color: "#00ffff"};
          }
        }
    }).addTo(map);
      
    });
    
  </script>
</body>
</html>